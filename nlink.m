function X_dot = nlink(y,m,l1,g,u)
    
    th1 = y(1);
    th2 = y(2);
    th3 = y(3);
    w1 = y(4);
    w2 = y(5);
    w3 = y(6);
    
    th12 = th1 + th2;
    th123 = th12 + th3;
    
    T1 = u(4);
    T2 = u(5);
    T3 = u(6);
    
    X_dot(1,1) = w1;
    X_dot(2,1) = w2;
    X_dot(3,1) = w3;
    X_dot(4,1) = (2124*T2 - 2124*T1 + 3456*T3*cos(th2 + th3) + 2736*T2*cos(th2) - 2736*T3*cos(th2) - 288*T2*cos(th2 + 2*th3) - 1728*T3*cos(th2 - th3) + 288*T3*cos(th2 + 2*th3) + 144*T1*cos(2*th3) - 144*T2*cos(2*th3) + 38*l1^2*m*w1^2*sin(th2 + th3) - 21*l1^2*m*w2^2*sin(th2 + th3) + 318*l1^2*m*w1^2*sin(th2) - 36*l1^2*m*w2^2*sin(th2) + 2064*g*l1*m*sin(th1) + 17*l1^2*m*w1^2*sin(th2 - th3) + 12*l1^2*m*w1^2*sin(th2 + 2*th3) + 19*l1^2*m*w2^2*sin(th2 - th3) + 12*l1^2*m*w2^2*sin(th2 - 2*th3) + 24*l1^2*m*w2^2*sin(th2 + 2*th3) + 2*l1^2*m*w2^2*sin(th2 + 3*th3) - 36*g*l1*m*sin(th1 + 2*th2 + 2*th3) + 204*l1^2*m*w1^2*sin(2*th2) - 306*g*l1*m*sin(th1 + 2*th2) - 48*g*l1*m*sin(th1 - 2*th3) - 48*g*l1*m*sin(th1 + 2*th3) + 24*l1^2*m*w1^2*sin(2*th2 + 2*th3) + 76*l1^2*m*w1*w2*sin(th2 + th3) + 76*l1^2*m*w1*w3*sin(th2 + th3) - 42*l1^2*m*w2*w3*sin(th2 + th3) + 636*l1^2*m*w1*w2*sin(th2) + 34*l1^2*m*w1*w2*sin(th2 - th3) + 24*l1^2*m*w1*w2*sin(th2 + 2*th3) + 34*l1^2*m*w1*w3*sin(th2 - th3) + 38*l1^2*m*w2*w3*sin(th2 - th3) + 4*l1^2*m*w2*w3*sin(th2 + 3*th3))/(4*l1^2*m*(51*cos(2*th2) + 28*cos(2*th3) + 6*cos(2*th2 + 2*th3) - 521));
    X_dot(5,1) =  -(21708*T2 - 2124*T1 - 19584*T3 - 576*T2*cos(2*th2 + 2*th3) + 576*T3*cos(2*th2 + 2*th3) + 3456*T3*cos(th2 + th3) - 2736*T1*cos(th2) + 5472*T2*cos(th2) - 2736*T3*cos(th2) - 19584*T3*cos(th3) + 288*T1*cos(th2 + 2*th3) - 576*T2*cos(th2 + 2*th3) - 1728*T3*cos(th2 - th3) + 288*T3*cos(th2 + 2*th3) + 3456*T3*cos(2*th2 + th3) + 144*T1*cos(2*th3) - 144*T2*cos(2*th3) + 38*l1^2*m*w1^2*sin(th2 + th3) - 21*l1^2*m*w2^2*sin(th2 + th3) + 240*g*l1*m*sin(th1 + th2 + 2*th3) + 3262*l1^2*m*w1^2*sin(th2) - 230*l1^2*m*w1^2*sin(th3) - 36*l1^2*m*w2^2*sin(th2) - 272*l1^2*m*w2^2*sin(th3) - 2892*g*l1*m*sin(th1 + th2) + 2064*g*l1*m*sin(th1) + 17*l1^2*m*w1^2*sin(th2 - th3) - 212*l1^2*m*w1^2*sin(th2 + 2*th3) + 34*l1^2*m*w1^2*sin(2*th2 + th3) + 19*l1^2*m*w2^2*sin(th2 - th3) + 12*l1^2*m*w2^2*sin(th2 - 2*th3) + 24*l1^2*m*w2^2*sin(th2 + 2*th3) - 4*l1^2*m*w2^2*sin(2*th2 + th3) + 2*l1^2*m*w2^2*sin(th2 + 3*th3) + 96*g*l1*m*sin(th2 - th1 + 2*th3) - 36*g*l1*m*sin(th1 + 2*th2 + 2*th3) + 408*l1^2*m*w1^2*sin(2*th2) - 112*l1^2*m*w1^2*sin(2*th3) - 24*l1^2*m*w2^2*sin(2*th2) - 136*l1^2*m*w2^2*sin(2*th3) + 1524*g*l1*m*sin(th1 - th2) - 306*g*l1*m*sin(th1 + 2*th2) - 48*g*l1*m*sin(th1 - 2*th3) - 48*g*l1*m*sin(th1 + 2*th3) + 24*l1^2*m*w1^2*sin(2*th2 + 2*th3) + 24*l1^2*m*w2^2*sin(2*th2 + 2*th3) + 4*l1^2*m*w2^2*sin(2*th2 + 3*th3) + 8*l1^2*m*w2*w3*sin(2*th2 + 3*th3) + 76*l1^2*m*w1*w2*sin(th2 + th3) + 76*l1^2*m*w1*w3*sin(th2 + th3) - 42*l1^2*m*w2*w3*sin(th2 + th3) + 636*l1^2*m*w1*w2*sin(th2) - 460*l1^2*m*w1*w2*sin(th3) - 460*l1^2*m*w1*w3*sin(th3) - 544*l1^2*m*w2*w3*sin(th3) + 34*l1^2*m*w1*w2*sin(th2 - th3) + 24*l1^2*m*w1*w2*sin(th2 + 2*th3) + 68*l1^2*m*w1*w2*sin(2*th2 + th3) + 34*l1^2*m*w1*w3*sin(th2 - th3) + 68*l1^2*m*w1*w3*sin(2*th2 + th3) + 38*l1^2*m*w2*w3*sin(th2 - th3) - 8*l1^2*m*w2*w3*sin(2*th2 + th3) + 4*l1^2*m*w2*w3*sin(th2 + 3*th3) + 408*l1^2*m*w1*w2*sin(2*th2) - 224*l1^2*m*w1*w2*sin(2*th3))/(4*l1^2*m*(51*cos(2*th2) + 28*cos(2*th3) + 6*cos(2*th2 + 2*th3) - 521));
    X_dot(6,1) = -(51552*T3 - 4896*T2 + 144*T2*cos(2*th2 + 2*th3) - 144*T3*cos(2*th2 + 2*th3) - 864*T1*cos(th2 + th3) + 864*T2*cos(th2 + th3) + 684*T1*cos(th2) - 684*T2*cos(th2) - 4896*T2*cos(th3) + 9792*T3*cos(th3) + 432*T1*cos(th2 - th3) - 72*T1*cos(th2 + 2*th3) - 432*T2*cos(th2 - th3) + 72*T2*cos(th2 + 2*th3) + 864*T2*cos(2*th2 + th3) - 1728*T3*cos(2*th2 + th3) - 5184*T3*cos(2*th2) + 816*l1^2*m*w1^2*sin(th2 + th3) + 360*g*l1*m*sin(th1 + th2 - th3) - 144*g*l1*m*sin(th1 - th2 + th3) - 396*g*l1*m*sin(th2 - th1 + th3) - 60*g*l1*m*sin(th1 + th2 + 2*th3) - 736*l1^2*m*w1^2*sin(th2) + (1195*l1^2*m*w1^2*sin(th3))/2 + 716*l1^2*m*w2^2*sin(th3) + 723*g*l1*m*sin(th1 + th2) - 336*l1^2*m*w1^2*sin(th2 - th3) + 56*l1^2*m*w1^2*sin(th2 + 2*th3) + (55*l1^2*m*w1^2*sin(2*th2 + th3))/2 - 35*l1^2*m*w2^2*sin(2*th2 + th3) - 24*g*l1*m*sin(th2 - th1 + 2*th3) - 51*l1^2*m*w1^2*sin(2*th2) + 56*l1^2*m*w1^2*sin(2*th3) + 12*l1^2*m*w2^2*sin(2*th2) + 68*l1^2*m*w2^2*sin(2*th3) - 381*g*l1*m*sin(th1 - th2) - 828*g*l1*m*sin(th1 + th2 + th3) + 6*l1^2*m*w1^2*sin(2*th2 + 2*th3) + 36*l1^2*m*w2^2*sin(2*th2 - th3) - 12*l1^2*m*w2^2*sin(2*th2 + 2*th3) - l1^2*m*w2^2*sin(2*th2 + 3*th3) + 12*l1^2*m*w1*w2*sin(2*th2 + 2*th3) + 12*l1^2*m*w1*w3*sin(2*th2 + 2*th3) - 12*l1^2*m*w2*w3*sin(2*th2 + 2*th3) - 2*l1^2*m*w2*w3*sin(2*th2 + 3*th3) + 1195*l1^2*m*w1*w2*sin(th3) + 115*l1^2*m*w1*w3*sin(th3) + 136*l1^2*m*w2*w3*sin(th3) + 55*l1^2*m*w1*w2*sin(2*th2 + th3) - 17*l1^2*m*w1*w3*sin(2*th2 + th3) + 2*l1^2*m*w2*w3*sin(2*th2 + th3) - 102*l1^2*m*w1*w2*sin(2*th2) + 112*l1^2*m*w1*w2*sin(2*th3) + 56*l1^2*m*w1*w3*sin(2*th3) + 12*l1^2*m*w2*w3*sin(2*th2) + 68*l1^2*m*w2*w3*sin(2*th3))/(l1^2*m*(51*cos(2*th2) + 28*cos(2*th3) + 6*cos(2*th2 + 2*th3) - 521));
end

